<div class="admin-candidates container">
  <h3>Candidates</h3>

  <div class="filters mb-3 d-flex gap-2">
    <input class="form-control" placeholder="Search name/email/position" [(ngModel)]="search" />
    <select class="form-select" [(ngModel)]="statusFilter">
      <option value="">All</option>
      <option value="Pass">Pass</option>
      <option value="Fail">Fail</option>
    </select>
    <input class="form-control" type="number" placeholder="Min %" [(ngModel)]="minPercentage" />
    <button class="btn btn-primary" (click)="loadCandidates()">Filter</button>
    <button class="btn btn-outline-secondary" (click)="clearFilters()">Clear</button>
  </div>

  <div *ngIf="loading" class="text-center py-3">Loading...</div>

  <div *ngIf="!loading && candidates.length === 0" class="alert alert-info">No candidates found</div>

  <div *ngIf="!loading && candidates.length > 0" class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Position</th>
          <th>Interview #</th>
          <th>Latest Status</th>
          <th>%</th>
          <th>Score</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of candidates">
          <td>{{ c.firstName }} {{ c.lastName }}</td>
          <td>{{ c.email }}</td>
          <td>{{ c.positionTitle }}</td>
          <td>{{ c.interviewNumber }}</td>
          <td>{{ c.latestSession?.Status || c.latestSession?.Result?.Status || '-' }}</td>
          <td>{{ c.latestSession?.Result?.Percentage ?? '-' }}</td>
          <td>{{ c.latestSession?.Result?.TotalScore ?? '-' }} / {{ c.latestSession?.Result?.MaxPossibleScore ?? '-' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
